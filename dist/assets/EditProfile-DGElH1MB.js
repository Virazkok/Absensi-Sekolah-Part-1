import{r as l,a as b,j as e,b as g}from"./app-Db-aw5MQ.js";import{C as E}from"./camera-vtPbql0-.js";import{F as j,a as w}from"./EyeIcon-BKUwr5YV.js";/* empty css            */import"./createLucideIcon-BBcfScga.js";const L=()=>{const[t,m]=l.useState(null),[c,x]=l.useState(""),[r,y]=l.useState(""),[i,v]=l.useState(""),[u,N]=l.useState(null),[p,n]=l.useState(null),[o,k]=l.useState(!1),[d,S]=l.useState(!1),h=l.useRef(null);l.useEffect(()=>{b.get("/api/student/me").then(s=>{m(s.data),x(s.data.email)})},[]);const C=s=>{if(s.target.files?.[0]){N(s.target.files[0]);const a=new FileReader;a.onload=()=>{t&&m({...t,foto:a.result})},a.readAsDataURL(s.target.files[0])}},P=async s=>{s.preventDefault();try{n(null);const a=new FormData;a.append("email",c),r&&a.append("password_lama",r),i&&a.append("password_baru",i),u&&a.append("avatar",u);const f=await b.post("/api/student/update-profile",a,{headers:{"Content-Type":"multipart/form-data"}});f.data.user&&localStorage.setItem("user",JSON.stringify(f.data.user)),g.visit("/murid/home")}catch(a){a.response?.data?.message?n(a.response.data.message):n("Gagal update profil")}};return t?e.jsxs("div",{className:"max-w-sm mx-auto bg-white min-h-screen",children:[e.jsxs("div",{className:"bg-purple-700 p-4 flex items-center gap-4",children:[e.jsxs("div",{className:"relative w-24 h-24 flex-shrink-0",children:[e.jsx("img",{src:t.foto||t?.avatar||"/default-avatar.png",alt:"Foto Profil",className:"w-24 h-24 rounded-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>h.current?.click(),className:"absolute bottom-1 right-1 bg-orange-500 text-white p-2 rounded-full shadow-md hover:bg-orange-600",children:e.jsx(E,{size:18})}),e.jsx("input",{type:"file",ref:h,accept:"image/*",className:"hidden",onChange:C})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"font-semibold text-[23px] text-white",children:t.name}),e.jsx("p",{className:"text-xs text-gray-200",children:t.kelas?.name})]})]}),p&&e.jsx("p",{className:"text-red-500 text-sm p-3",children:p}),e.jsxs("form",{onSubmit:P,className:"p-4 space-y-5 text-gray-900",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold mb-2 text-base",children:"Biodata"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Nama Siswa"}),e.jsx("input",{type:"text",value:t.name,disabled:!0,className:"w-full border rounded px-2 py-1.5 text-sm bg-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Kelas"}),e.jsx("input",{type:"text",value:t.kelas?.name,disabled:!0,className:"w-full border rounded px-2 py-1.5 text-sm bg-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"NIS"}),e.jsx("input",{type:"text",value:t.nis||"",disabled:!0,className:"w-full border rounded px-2 py-1.5 text-sm bg-gray-100"})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold mb-2 text-base",children:"Akun"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:c,onChange:s=>x(s.target.value),className:"w-full border rounded px-2 py-1.5 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Password Aktif"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:o?"text":"password",placeholder:"Masukkan password lama",value:r,onChange:s=>y(s.target.value),className:"w-full border rounded px-2 py-1.5 text-sm pr-8"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-2 flex items-center",onClick:()=>k(!o),children:o?e.jsx(j,{className:"w-4 h-4 text-gray-500"}):e.jsx(w,{className:"w-4 h-4 text-gray-500"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Password Baru"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:d?"text":"password",placeholder:"Kosongkan jika tidak ingin ganti",value:i,onChange:s=>v(s.target.value),className:"w-full border rounded px-2 py-1.5 text-sm pr-8"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-2 flex items-center",onClick:()=>S(!d),children:d?e.jsx(j,{className:"w-4 h-4 text-gray-500"}):e.jsx(w,{className:"w-4 h-4 text-gray-500"})})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{type:"submit",className:"w-full bg-orange-500 text-white py-2 rounded-lg text-sm font-medium shadow-md active:scale-[0.98] transition",children:"Simpan"}),e.jsx("button",{type:"button",onClick:()=>g.visit("/murid/home"),className:"w-full bg-white text-black border border-orange-400 py-2 rounded-lg text-sm font-medium shadow-md active:scale-[0.98] transition",children:"Batal"})]})]})]}):e.jsx("p",{className:"p-4",children:"Loading..."})};export{L as default};
