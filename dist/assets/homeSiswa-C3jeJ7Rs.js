import{r as t,j as e,H as C,a as g}from"./app-Db-aw5MQ.js";import{B as I}from"./BottomNavbar-CPs9VJ6F.js";/* empty css            */g.defaults.withCredentials=!0;g.defaults.baseURL="http://127.0.0.1:8000";const E=()=>{const[o,w]=t.useState(new Date),[s,b]=t.useState(null),[k,l]=t.useState("--"),[y,p]=t.useState(null),[v,m]=t.useState(null),[u,j]=t.useState(!1),[i,h]=t.useState(!1);t.useEffect(()=>{const a=setInterval(()=>w(new Date),1e3);return()=>clearInterval(a)},[]),t.useEffect(()=>{const a=JSON.parse(localStorage.getItem("user")||"{}");a&&a.id&&(console.log("ðŸ“¦ User dari localStorage:",a),b(a))},[]),t.useEffect(()=>{s&&(console.log("ðŸ‘¤ State user sekarang:",s),console.log("ðŸ–¼ Avatar yang dipakai:",s.avatar))},[s]),t.useEffect(()=>{if(!s)return;(async()=>{try{const c=await g.get("/api/kehadiran"),n=new Date().toLocaleDateString("sv-SE"),r=c.data.find(d=>{const x=new Date(d.tanggal).toLocaleDateString("sv-SE");return d.murid_id===s.id&&x===n});r?(j(!0),p(r.jam_masuk||null),l(r.kehadiran||"Hadir"),r.jam_keluar&&(h(!0),m(r.jam_keluar),l("Pulang")),r.jam_terlambat&&(h(!0),m(r.jam_terlambat),l("Terlambat"))):(j(!1),h(!1),p(null),m(null),l("--"))}catch(c){console.error("Gagal fetch presensi:",c)}})()},[s]);const N=o.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long"}),S=o.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),_=()=>{const a=o.getHours(),c=o.getMinutes(),n=a*60+c,r=540,d=1204,x=1260,f=1324;return u&&!i&&n>=f&&l("-"),n<r||n>=f?e.jsx("div",{className:"mt-10 w-56 h-56 rounded-full bg-gray-200 flex items-center justify-center text-center text-gray-500 shadow-inner",children:"Absensi Tutup"}):u?u&&!i&&n<x?e.jsxs("div",{className:"mt-10 w-56 h-56 rounded-full bg-gray-200 flex items-center justify-center text-lg text-gray-600 text-center p-4 font-medium shadow-inner  ",children:["Sudah Check In",e.jsx("br",{}),"Tunggu jam pulang"]}):u&&!i&&n>=x&&n<f?e.jsx("button",{onClick:()=>window.location.href="/murid/home/qr/checkOut",className:`mt-10 w-[180px] h-[180px] rounded-full bg-[#A22C29] text-white flex items-center justify-center 
                      text-base font-normal leading-none 
                      shadow-[0px_0px_1px_20px_rgba(209,74,74,100),0px_0px_30px_35px_rgba(209,74,74,100)]`,children:"Tap Check Out"}):i?e.jsx("div",{className:"mt-10 w-56 h-56 rounded-full bg-green-200 flex items-center justify-center text-lg text-gray-700",children:"Sesi sudah selesai"}):null:n>d?e.jsx("div",{className:"mt-10 w-56 h-56 rounded-full bg-gray-300 flex items-center justify-center shadow-inner text-lg text-gray-600",children:"Absensi ditutup"}):e.jsx("button",{onClick:()=>window.location.href="/murid/home/qr/checkIn",className:`mt-5 w-[160px] h-[160px] rounded-full bg-[#34A853] text-white flex items-center justify-center 
                     text-base font-normal leading-none 
                     shadow-[0px_0px_1px_20px_rgba(144,221,165,100),0px_0px_30px_35px_rgba(144,221,165,100)]`,children:"Tap Check In"})};return e.jsxs("div",{className:"min-h-screen flex flex-col justify-between items-center pt-4 pb-30 px-4 bg-white",children:[e.jsx(C,{title:"Home"}),e.jsxs("div",{className:"flex items-center gap-4 w-full",children:[e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden border-2 border-gray-300 shadow",children:e.jsx("img",{src:s?.avatar||"/default-avatar.png",alt:"Foto Profil",className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-600",children:s?.name||"Nama Siswa"}),e.jsx("p",{className:"text-gray-600",children:s?.kelas?.name||"Kelas"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-5xl font-bold text-gray-900",children:S}),e.jsx("p",{className:"text-lg text-gray-700 capitalize",children:N})]}),_(),e.jsx("div",{className:"w-full mt-4 mb-10 text-center",children:e.jsxs("div",{className:"flex justify-around",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-gray-500",children:"Status"}),e.jsx("p",{className:"text-xl font-medium text-gray-600",children:k})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-gray-500",children:"Waktu"}),e.jsx("p",{className:"text-xl font-medium text-gray-600",children:i?v||"-- : --":y||"-- : --"})]})]})}),e.jsx(I,{})]})};export{E as default};
