import{u as P,r as a,a as Y,j as e}from"./app-XaT7IJdh.js";import{B as K}from"./BottomNavbarOrtu-6h9e5Rm6.js";import{c as A}from"./createLucideIcon-PjBRytQg.js";import{S as B}from"./sliders-horizontal-8qvEX_Aq.js";/* empty css            *//**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],J=A("Download",H);function V(){const w=P(),S=w.props.kelas,D=w.props.eskul,d=new URLSearchParams(window.location.search),_=d.get("type")||"sekolah",[s,O]=a.useState(_),[x,C]=a.useState(d.get("kelas_id")||""),[h,E]=a.useState(d.get("eskul_id")||""),[n,M]=a.useState("weekly"),[u,I]=a.useState(d.get("search")||""),[k,f]=a.useState([]),[L,N]=a.useState(!1),[o,y]=a.useState(0),[r,m]=a.useState(new Date().getMonth()),[c,b]=a.useState(new Date().getFullYear()),[g,W]=a.useState(null);a.useEffect(()=>{R()},[s,x,h,n,o,r,c,g,u]);async function R(){N(!0);try{let t={type:s,kelas_id:x||void 0,search:u||void 0};s==="eskul"&&h&&(t.eskul_id=h),t.mode=n,n==="weekly"&&(t.week=o),n==="monthly"&&(t.month=r+1,t.year=c),n==="semester"&&g&&(t.semester=g,t.year=c);const i=await Y.get("/api/riwayat-kehadiran",{params:t});f(i.data.success?i.data.data||[]:[])}catch(t){console.error("Fetch error",t),f([])}finally{N(!1)}}function $(t){const i=new Date,j=new Date(i);j.setDate(j.getDate()+t*7);const l=new Date(j),v=l.getDay(),T=l.getDate()-v+(v===0?-6:1);l.setDate(T);const p=new Date(l);return p.setDate(l.getDate()+6),`${l.getDate()} ${l.toLocaleString("id-ID",{month:"long"})} ${l.getFullYear()} - ${p.getDate()} ${p.toLocaleString("id-ID",{month:"long"})} ${p.getFullYear()}`}const F=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];return e.jsxs("div",{className:"min-h-screen bg-white p-4 text-gray-900 pb-20 text-[12px]",children:[e.jsx("div",{className:"flex justify-between items-center mb-15",children:e.jsx("h2",{className:"text-lg font-semibold text-[28px]",children:s==="sekolah"?"Rekap Kehadiran":s==="eskul"?"Rekap Ekstrakurikuler":"Rekap Event"})}),e.jsx("div",{className:"flex flex-row-reverse justify-between items-center mb-4",children:e.jsxs("button",{className:"flex items-center gap-2 text-sm   px-3 py-1 rounded-lg hover:bg-gray-50",children:[e.jsx(J,{size:16})," download file"]})}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[s==="eskul"&&e.jsxs("select",{value:h,onChange:t=>E(t.target.value),className:"border px-3 py-2 rounded-lg shadow-sm focus:ring-2 focus:ring-orange-500 w-44",children:[e.jsx("option",{value:"",children:"Pilih Ekstrakurikuler"}),D.map(t=>e.jsx("option",{value:t.id,children:t.nama},t.id))]}),e.jsxs("select",{value:x,onChange:t=>C(t.target.value),className:"px-3 py-2 border border-orange-500 rounded-lg shadow-sm max-w-44 h-11 flex-1",children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),S.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("input",{type:"text",placeholder:"cari",value:u,onChange:t=>I(t.target.value),className:"px-3 py-2 border border-orange-500 rounded-lg shadow-sm max-w-44 flex-1"})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mr-[60px]",children:[e.jsx(B,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"text-sm",children:"Filter "})]}),["weekly","monthly","semester"].map(t=>e.jsx("button",{onClick:()=>M(t),className:` py-1 rounded-lg text-sm shadow-sm w-18  ${n===t?"bg-orange-500 text-white":"border border-orange-500 text-orange-500"}`,children:t==="weekly"?"Mingguan":t==="monthly"?"Bulanan":"Semester"},t))]}),n==="weekly"&&e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[e.jsx("button",{onClick:()=>y(o-1),children:"←"}),e.jsx("span",{className:"font-semibold",children:$(o)}),e.jsx("button",{onClick:()=>y(o+1),children:"→"})]}),n==="monthly"&&e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[e.jsx("button",{onClick:()=>{r===0?(m(11),b(c-1)):m(r-1)},children:"←"}),e.jsxs("span",{className:"font-semibold",children:[F[r]," ",c]}),e.jsx("button",{onClick:()=>{r===11?(m(0),b(c+1)):m(r+1)},children:"→"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-center whitespace-nowrap",children:"Nama"}),e.jsx("th",{className:"p-2 text-center whitespace-nowrap",children:"NIS"}),e.jsx("th",{className:"p-2 text-center whitespace-nowrap",children:"Kelas"}),s==="eskul"&&e.jsx("th",{className:"p-2 text-center whitespace-nowrap",children:"Nama Eskul"}),s==="event"&&e.jsx("th",{className:"p-2 text-center whitespace-nowrap",children:"Nama Event"}),e.jsx("th",{className:"p-2 text-center ",children:"Total Hadir"}),s!=="event"&&e.jsx("th",{className:"p-2 text-center ",children:"Total Absen"})]})}),e.jsx("tbody",{children:L?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Memuat..."})}):k.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Tidak ada data"})}):k.map((t,i)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 whitespace-nowrap",children:t.student_name||t.nama}),e.jsx("td",{className:"p-2 whitespace-nowrap",children:t.nis}),e.jsx("td",{className:"p-2 whitespace-nowrap",children:t.kelas}),s==="eskul"&&e.jsx("td",{className:"p-2 whitespace-nowrap",children:t.nama||t.nama_eskul}),s==="event"&&e.jsx("td",{className:"p-2 whitespace-nowrap",children:t.nama_event}),e.jsx("td",{className:"p-2 whitespace-nowrap",children:t.total_hadir}),s!=="event"&&e.jsx("td",{className:"p-2 whitespace-nowrap",children:t.absen})]},i))})]})}),e.jsx(K,{})]})}export{V as default};
