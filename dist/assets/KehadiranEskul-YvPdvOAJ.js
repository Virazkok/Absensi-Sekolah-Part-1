import{u as b,r as n,j as e,H as g,a as j}from"./app-Db-aw5MQ.js";import{A as w}from"./AuthenticatedLayout-CS7Tii-L.js";import{B as k}from"./BottomNavbar-CPs9VJ6F.js";import{C as y}from"./camera-vtPbql0-.js";/* empty css            */import"./createLucideIcon-BBcfScga.js";function A(){const{props:x}=b(),{auth:r,absensi:h,kehadiran:t}=x,[d,o]=n.useState(null),[l,p]=n.useState(null),[i,c]=n.useState(!1),m=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),f=s=>{const a=s.target.files?.[0]||null;p(a),o(a?URL.createObjectURL(a):null)},u=async s=>{if(s==="Hadir"&&!l){alert("Harap ambil foto terlebih dahulu sebelum memilih Hadir!");return}c(!0);try{const a=new FormData;a.append("status",s),s==="Hadir"&&l&&a.append("foto",l),await j.post(`/murid/eskul/kehadiran/${h.id}`,a,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}),alert("Kehadiran berhasil disimpan!"),window.location.href="/murid/eskul"}catch(a){console.error("Gagal kirim kehadiran:",a),alert("Terjadi kesalahan saat menyimpan kehadiran.")}finally{c(!1)}};return e.jsxs(w,{user:r.user,children:[e.jsx(g,{title:"Kehadiran Eskul"}),e.jsxs("div",{className:"min-h-screen flex flex-col bg-white text-gray-900",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4",children:[e.jsx("img",{src:r.user.avatar||"/default-avatar.png",alt:"Profile",className:"w-14 h-14 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:r.user.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:r.user.kelas??"Kelas belum terisi"})]})]}),t?e.jsxs("div",{className:"flex flex-col items-center mt-6",children:[t.status==="Hadir"&&t.foto&&e.jsx("img",{src:`data:image/jpeg;base64,${t.foto}`,alt:"Foto Kehadiran",className:"w-[90%] max-w-sm aspect-square object-cover rounded-lg mb-4"}),e.jsxs("div",{className:`px-4 py-2 rounded-xl text-center text-white font-semibold ${t.status==="Hadir"?"bg-green-500":"bg-red-500"}`,children:["Status: ",t.status]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center mt-6 border-b border-t pb-4",children:[e.jsxs("label",{className:"relative w-[90%] max-w-sm aspect-square bg-gray-100 rounded-lg flex items-center justify-center cursor-pointer overflow-hidden",children:[d?e.jsx("img",{src:d,alt:"Preview",className:"object-cover w-full h-full"}):e.jsxs("div",{className:"flex flex-col items-center text-gray-500",children:[e.jsx(y,{className:"w-10 h-10 mb-3"}),e.jsx("p",{className:"text-xs bg-gray-200 px-4 py-1 rounded-full shadow",children:"Ambil foto dahulu untuk kehadiran eskul!"})]}),e.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:f,className:"absolute top-0 left-0 w-full h-full opacity-0 cursor-pointer",disabled:!m})]}),!m&&e.jsxs("p",{className:"text-red-500 text-sm mt-3 text-center px-4",children:["⚠️ Fitur kamera hanya tersedia di perangkat mobile. ",e.jsx("br",{}),"Silakan buka halaman ini melalui HP Anda."]})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-6 mb-6",children:[e.jsx("button",{onClick:()=>u("Hadir"),disabled:i,className:"bg-green-500 text-white text-sm px-6 py-2 rounded-lg shadow-md w-32 text-center",children:i?"Menyimpan...":"Hadir"}),e.jsx("button",{onClick:()=>u("Tidak Hadir"),disabled:i,className:"bg-red-500 text-white text-sm px-6 py-2 rounded-lg shadow-md w-32 text-center",children:i?"Menyimpan...":"Tidak Hadir"})]})]})]}),e.jsx(k,{})]})}export{A as default};
