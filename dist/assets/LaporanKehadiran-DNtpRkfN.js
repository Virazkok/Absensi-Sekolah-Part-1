import{j as e,r as c,R as E,a as M}from"./app-XaT7IJdh.js";import{B as p}from"./button-CJGk2xfH.js";import{I as V}from"./input-Ip1Z780n.js";import{S as Y,a as Z,b as G,c as Q,d as K}from"./select-DDqEtzWm.js";import{c as A}from"./utils-NikRBbYi.js";import{F as X}from"./filter-NsWfKLvW.js";import{C as ee}from"./chevron-left--oAHYdWf.js";import{C as ae}from"./chevron-right-OCH7eLeA.js";import{c as te}from"./createLucideIcon-PjBRytQg.js";/* empty css            */import"./clsx-B-dksMZM.js";import"./index-DJvn5aD7.js";import"./index-BLXukw4F.js";import"./index-DdspcVZP.js";import"./index-CArVgHNd.js";import"./index-DHwZL11B.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],re=te("FileDown",se);function ne({className:t,...d}){return e.jsx("div",{"data-slot":"card",className:A("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...d})}function le({className:t,...d}){return e.jsx("div",{"data-slot":"card-content",className:A("px-6",t),...d})}const Ne=()=>{const[t,d]=c.useState("monthly"),[h,k]=c.useState(new Date().getMonth()+1),[n,y]=c.useState(new Date().getFullYear()),[x,v]=c.useState(new Date().getMonth()+1<=6?2:1),[F,R]=c.useState([]),[I,B]=c.useState(""),w=(a=new Date)=>{const s=new Date(a),r=s.getDay(),j=s.getDate()-r+(r===0?-6:1),m=new Date(s.setDate(j)),u=new Date(m);return u.setDate(m.getDate()+4),{start:m,end:u}},[f,L]=c.useState(w().start),[S,P]=c.useState(w().end),T=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],z=(a,s)=>{if(s===0)return"-";const r=a/s*100;return r<50?"Kurang":r>=50&&r<=60?"Cukup":r>=61&&r<=74?"Baik":"Sangat Baik"},H=async()=>{try{let a={};if(t==="weekly")a={range:"mingguan",start_date:f.toISOString().split("T")[0],end_date:S.toISOString().split("T")[0]};else if(t==="semester"){let l,i;x===1?(l=new Date(n,6,2),i=new Date(n,11,31)):(l=new Date(n+1,0,2),i=new Date(n+1,5,31)),a={range:"semester",semester:x,tahun:n,start_date:l.toISOString().split("T")[0],end_date:i.toISOString().split("T")[0]}}else a={range:"bulanan",bulan:h,tahun:n};const[s,r,j]=await Promise.all([M.get("/api/laporan/sekolah",{params:a}),M.get("/api/laporan/eskul",{params:a}),M.get("/api/laporan/event",{params:a})]),m=new Map,u=(l,i)=>{Array.isArray(l)&&l.forEach(o=>{const C=o.nama||"-",b=m.get(C)||{nama:C,kelas:o.kelas||"-",keahlian:o.kejuruan||o.keahlian||"-",hadirSekolah:0,hadirEskul:0,hadirEvent:0,keterangan:"-"};i==="sekolah"&&(b.hadirSekolah+=o.hadir_sekolah||0),i==="eskul"&&(b.hadirEskul+=o.hadir_ekskul||0),i==="event"&&(b.hadirEvent+=o.hadir_event||0),m.set(C,b)})};u(s.data.data||[],"sekolah"),u(r.data.data||[],"eskul"),u(j.data.data||[],"event");const U=Array.from(m.values()).map(l=>{const i=l.hadirSekolah+l.hadirEskul+l.hadirEvent,o=i+2;return{...l,keterangan:z(i,o)}});R(U)}catch(a){console.error("Error fetching laporan:",a)}};c.useEffect(()=>{H()},[t,h,n,x,f,S]);const O=()=>{if(t==="semester")x===1?v(2):(v(1),y(n+1));else if(t==="weekly"){const a=new Date(f);a.setDate(a.getDate()+7);const{start:s,end:r}=w(a);L(s),P(r)}else h===12?(k(1),y(n+1)):k(h+1)},J=()=>{if(t==="semester")x===2?v(1):(v(2),y(n-1));else if(t==="weekly"){const a=new Date(f);a.setDate(a.getDate()-7);const{start:s,end:r}=w(a);L(s),P(r)}else h===1?(k(12),y(n-1)):k(h-1)},D=F.filter(a=>a.nama.toLowerCase().includes(I.toLowerCase())),N=15,[g,W]=E.useState(1),$=Math.ceil(D.length/N),q=E.useMemo(()=>{const a=(g-1)*N;return D.slice(a,a+N)},[D,g]),_=Array.from({length:$},(a,s)=>s+1).filter(a=>a===1||a===$||a>=g-2&&a<=g+2);return e.jsxs("div",{className:"flex bg-gray-100 min-h-screen text-gray-900",children:[e.jsx("aside",{className:"hidden md:block md:w-60 bg-white p-4 shadow-lg min-h-screen",children:e.jsxs("nav",{className:"space-y-2 text-sm",children:[e.jsxs("div",{onClick:()=>window.location.href="/Admin/Dashboard",className:"p-2 rounded hover:bg-gray-200 cursor-pointer flex items-center gap-2",children:[e.jsx("img",{src:"/icons/ri--dashboard-line.svg",alt:""}),"Dashboard"]}),e.jsxs("div",{onClick:()=>window.location.href="/Admin/UserManagement",className:"p-2 rounded hover:bg-gray-200 cursor-pointer flex items-center gap-2",children:[e.jsx("img",{src:"/icons/ri--user-settings-line.svg",alt:""}),"User Manajemen"]}),e.jsxs("div",{onClick:()=>window.location.href="/admin/events",className:"p-2 rounded hover:bg-gray-200 cursor-pointer flex items-center gap-2",children:[e.jsx("img",{src:"/icons/ri--list-settings-line.svg",alt:""}),"Event Manajemen"]}),e.jsxs("div",{onClick:()=>window.location.href="/admin/eskul",className:"p-2 rounded hover:bg-gray-200 cursor-pointer flex items-center gap-2",children:[e.jsx("img",{src:"/icons/ri--user-community-line.svg",alt:""}),"Ekstrakurikuler"]}),e.jsxs("div",{onClick:()=>window.location.href="/admin/riwayat-kehadiran",className:"p-2 rounded hover:bg-gray-200 cursor-pointer flex items-center gap-2",children:[e.jsx("img",{src:"/icons/ri--history-line.svg",alt:""}),"Riwayat Kehadiran"]}),e.jsxs("div",{onClick:()=>window.location.href="/admin/statistik-kehadiran",className:"p-2 rounded hover:bg-gray-200 cursor-pointer flex items-center gap-2",children:[e.jsx("img",{src:"/icons/ri--pie-chart-2-line.svg",alt:""}),"Statistik Kehadiran"]}),e.jsxs("div",{onClick:()=>window.location.href="/admin/laporan-kehadiran",className:"p-2 rounded bg-[#E86D1F] font-medium cursor-pointer text-white flex items-center gap-2",children:[e.jsx("img",{src:"/icons/ri--file-text-lineW.svg",alt:""}),"Laporan"]})]})}),e.jsxs("main",{className:"flex-1 p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Laporan Kehadiran"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-300"}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Admin"})]})]}),e.jsx(ne,{className:"border-2 border-purple-300 rounded-2xl bg-white shadow-sm",children:e.jsxs(le,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 font-semibold",children:[e.jsx(X,{size:16}),e.jsx("span",{children:"Filter"})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{variant:t==="weekly"?"default":"outline",className:`rounded-full ${t==="weekly"?"bg-purple-600 text-white":""}`,onClick:()=>d("weekly"),children:"Mingguan"}),e.jsx(p,{variant:t==="monthly"?"default":"outline",className:`rounded-full ${t==="monthly"?"bg-purple-600 text-white":""}`,onClick:()=>d("monthly"),children:"Bulanan"}),e.jsx(p,{variant:t==="semester"?"default":"outline",className:`rounded-full ${t==="semester"?"bg-purple-600 text-white":""}`,onClick:()=>d("semester"),children:"Semester"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Y,{children:[e.jsx(Z,{className:"w-40",children:e.jsx(G,{placeholder:"Semua Keahlian"})}),e.jsxs(Q,{children:[e.jsx(K,{value:"all",children:"Semua Keahlian"}),e.jsx(K,{value:"rpl",children:"RPL"}),e.jsx(K,{value:"tkj",children:"TKJ"})]})]}),e.jsx(V,{placeholder:"Cari nama...",className:"w-44",value:I,onChange:a=>B(a.target.value)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-gray-900",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:J,children:e.jsx(ee,{size:18})}),e.jsx("span",{className:"font-semibold",children:t==="semester"?`Semester ${x} ${n}`:t==="weekly"?`${f.toLocaleDateString("id-ID",{day:"2-digit",month:"long"})} - ${S.toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"})}`:`${T[h-1]} ${n}`}),e.jsx(p,{variant:"ghost",size:"icon",onClick:O,children:e.jsx(ae,{size:18})})]}),e.jsx("div",{className:"overflow-x-auto text-gray-900",children:e.jsxs("table",{className:"w-full border-t border-gray-300 text-sm",children:[e.jsx("thead",{className:"text-gray-600 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-3 text-left",children:"No"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Nama"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Kelas"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Keahlian"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Hadir Sekolah"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Hadir Eskul"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Hadir Event"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Keterangan"})]})}),e.jsx("tbody",{children:q.map((a,s)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-3",children:(g-1)*N+s+1}),e.jsx("td",{className:"py-2 px-3",children:a.nama}),e.jsx("td",{className:"py-2 px-3",children:a.kelas}),e.jsx("td",{className:"py-2 px-3",children:a.keahlian}),e.jsx("td",{className:"py-2 px-3",children:a.hadirSekolah}),e.jsx("td",{className:"py-2 px-3",children:a.hadirEskul}),e.jsx("td",{className:"py-2 px-3",children:a.hadirEvent}),e.jsx("td",{className:`py-2 px-3 font-semibold ${a.keterangan==="Sangat Baik"?"text-green-600":a.keterangan==="Baik"?"text-blue-600":a.keterangan==="Cukup"?"text-yellow-600":a.keterangan==="Kurang"?"text-red-600":""}`,children:a.keterangan})]},s))})]})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx("div",{className:"mt-4 flex justify-start",children:e.jsxs(p,{className:"bg-gray-100 text-gray-800 border hover:bg-gray-200",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Download Report"]})}),e.jsx("div",{className:"flex items-center gap-1 border rounded-full px-3 py-1 bg-white shadow-sm",children:_.map((a,s)=>{const r=_[s-1],j=r&&a-r>1;return e.jsxs(E.Fragment,{children:[j&&e.jsx("span",{className:"px-2 text-gray-400",children:"â€¦"}),e.jsx("button",{onClick:()=>W(a),className:`px-3 py-1.5 rounded-full transition-all ${g===a?"bg-orange-400 text-white":"text-gray-700 hover:bg-gray-100"}`,children:a})]},a)})})]})]})})]})]})};export{Ne as default};
